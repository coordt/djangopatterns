{"body": "<div class=\"section\" id=\"lazy-manager-insertion\">\n<h1>Lazy Manager Insertion<a class=\"headerlink\" href=\"#lazy-manager-insertion\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<div class=\"admonition warning\">\n<p class=\"first admonition-title\">Warning</p>\n<a name=\"67c197e78f40e9995f19c35bb764e8c7d3615e98\"></a><p class=\"last cn\" id=\"67c197e78f40e9995f19c35bb764e8c7d3615e98\">This is just a stub document. It will be fleshed out more. Please don't comment on it.</p>\n</div>\n<a name=\"33dfffdc6daca8fa88bbac9140346abd16cd0095\"></a><p class=\"cn\" id=\"33dfffdc6daca8fa88bbac9140346abd16cd0095\">Loosely based on Django-mptt. It is very similar to how we handled inserting a field.</p>\n<div class=\"highlight-python\"><div class=\"highlight\"><pre><span class=\"n\">COOLAPP_MODELS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s\">&#39;app1.Model&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;cool_manager&#39;</span><span class=\"p\">,</span>\n    <span class=\"s\">&#39;app2.Model&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;cool_manager&#39;</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n<a name=\"0c879f7517b59fc397fb136f2b09b23aaba2d813\"></a><p class=\"cn\" id=\"0c879f7517b59fc397fb136f2b09b23aaba2d813\">At the bottom of this app\u2019s models.py, you can read the configuration from settings.</p>\n<a name=\"818741d17bc8dc68da0ff527aa5a7cd68dd607e9\"></a><p class=\"cn\" id=\"818741d17bc8dc68da0ff527aa5a7cd68dd607e9\">loop through them and Do a bit of error checking</p>\n<a name=\"cfb633eb2deff7c073a679a18a0e9d2c7fd93eaa\"></a><p class=\"cn\" id=\"cfb633eb2deff7c073a679a18a0e9d2c7fd93eaa\">Load the model class</p>\n<a name=\"e6861a0db12657d4fa8f3c8e5eb6dc0f3eb50dfc\"></a><p class=\"cn\" id=\"e6861a0db12657d4fa8f3c8e5eb6dc0f3eb50dfc\">Loop through the given fields</p>\n<a name=\"0e3768d841005c2ecf95c14dfcda55c5f2a7b01a\"></a><p class=\"cn\" id=\"0e3768d841005c2ecf95c14dfcda55c5f2a7b01a\">We make sure that the model doesn\u2019t have an attribute by the same name, we add the field to the model by instantiating the manager and calling its contribute_to_class method.</p>\n<div class=\"highlight-python\"><pre>from django.db.models import get_model\nimport django.conf import settings\nfrom coolapp.managers import CustomManager\n\nMODELS = getattr(settings, 'COOLAPP_MODELS', {})\n\nfor model_name, mgr_name in MODELS.items():\n    if not isinstance(model_name, basestring):\n        continue\n\n    model = get_model(*model_name.split('.'))\n\n    if not getattr(model, mgr_name, False):\n        manager = CustomManager()\n        manager.contribute_to_class(model, mgr_name)</pre>\n</div>\n</div>\n", "display_toc": false, "title": "Lazy Manager Insertion", "sourcename": "decorator_apps/lazy_manager_insertion.txt", "customsidebar": null, "current_page_name": "decorator_apps/lazy_manager_insertion", "next": {"link": "../../app_construction/", "title": "Application Construction"}, "rellinks": [["genindex", "General Index", "I", "index"], ["app_construction/index", "Application Construction", "N", "next"], ["decorator_apps/lazy_field_insertion", "Lazy Field Insertion", "P", "previous"]], "meta": {}, "parents": [{"link": "../", "title": "Decorator App Patterns"}], "sidebars": null, "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Lazy Manager Insertion</a></li>\n</ul>\n", "prev": {"link": "../lazy_field_insertion/", "title": "Lazy Field Insertion"}, "metatags": ""}