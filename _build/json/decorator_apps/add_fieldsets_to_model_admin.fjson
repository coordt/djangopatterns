{"body": "<div class=\"section\" id=\"adding-fieldsets-to-a-model-s-admin\">\n<h1>Adding fieldsets to a model's admin<a class=\"headerlink\" href=\"#adding-fieldsets-to-a-model-s-admin\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<div class=\"highlight-python\"><div class=\"highlight\"><pre><span class=\"k\">for</span> <span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"n\">modeladmin</span> <span class=\"ow\">in</span> <span class=\"n\">admin</span><span class=\"o\">.</span><span class=\"n\">site</span><span class=\"o\">.</span><span class=\"n\">_registry</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">():</span>\n    <span class=\"k\">if</span> <span class=\"n\">model</span> <span class=\"ow\">in</span> <span class=\"n\">model_registry</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">()</span> <span class=\"ow\">and</span> <span class=\"n\">modeladmin</span><span class=\"o\">.</span><span class=\"n\">fieldsets</span><span class=\"p\">:</span>\n        <span class=\"n\">fieldsets</span> <span class=\"o\">=</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"n\">modeladmin</span><span class=\"p\">,</span> <span class=\"s\">&#39;fieldsets&#39;</span><span class=\"p\">,</span> <span class=\"p\">())</span>\n        <span class=\"n\">fields</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">cat</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s\">&#39;.&#39;</span><span class=\"p\">)[</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">cat</span> <span class=\"ow\">in</span> <span class=\"n\">registry</span> <span class=\"k\">if</span> <span class=\"n\">registry</span><span class=\"p\">[</span><span class=\"n\">cat</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"n\">model</span><span class=\"p\">]</span>\n        <span class=\"c\"># check each field to see if already defined</span>\n        <span class=\"k\">for</span> <span class=\"n\">cat</span> <span class=\"ow\">in</span> <span class=\"n\">fields</span><span class=\"p\">:</span>\n            <span class=\"k\">for</span> <span class=\"n\">k</span><span class=\"p\">,</span><span class=\"n\">v</span> <span class=\"ow\">in</span> <span class=\"n\">fieldsets</span><span class=\"p\">:</span>\n                <span class=\"k\">if</span> <span class=\"n\">cat</span> <span class=\"ow\">in</span> <span class=\"n\">v</span><span class=\"p\">[</span><span class=\"s\">&#39;fields&#39;</span><span class=\"p\">]:</span>\n                    <span class=\"n\">fields</span><span class=\"o\">.</span><span class=\"n\">remove</span><span class=\"p\">(</span><span class=\"n\">cat</span><span class=\"p\">)</span>\n        <span class=\"c\"># if there are any fields left, add them under the categories fieldset</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">fields</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"k\">print</span> <span class=\"n\">fields</span>\n            <span class=\"n\">admin</span><span class=\"o\">.</span><span class=\"n\">site</span><span class=\"o\">.</span><span class=\"n\">unregister</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">)</span>\n            <span class=\"n\">admin</span><span class=\"o\">.</span><span class=\"n\">site</span><span class=\"o\">.</span><span class=\"n\">register</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"s\">&#39;newadmin&#39;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">modeladmin</span><span class=\"o\">.</span><span class=\"n\">__class__</span><span class=\"p\">,),</span> <span class=\"p\">{</span>\n                <span class=\"s\">&#39;fieldsets&#39;</span><span class=\"p\">:</span> <span class=\"n\">fieldsets</span> <span class=\"o\">+</span> <span class=\"p\">((</span><span class=\"s\">&#39;Categories&#39;</span><span class=\"p\">,</span> <span class=\"p\">{</span>\n                    <span class=\"s\">&#39;fields&#39;</span><span class=\"p\">:</span> <span class=\"n\">fields</span>\n                <span class=\"p\">}),)</span>\n            <span class=\"p\">}))</span>\n</pre></div>\n</div>\n</div>\n", "display_toc": false, "title": "Adding fieldsets to a model's admin", "sourcename": "decorator_apps/add_fieldsets_to_model_admin.txt", "customsidebar": null, "current_page_name": "decorator_apps/add_fieldsets_to_model_admin", "next": {"link": "../change_the_admin_widget/", "title": "Change the admin widget of a field"}, "rellinks": [["genindex", "General Index", "I", "index"], ["decorator_apps/change_the_admin_widget", "Change the admin widget of a field", "N", "next"], ["decorator_apps/index", "Decorator App Patterns", "P", "previous"]], "meta": {}, "parents": [{"link": "../", "title": "Decorator App Patterns"}], "sidebars": null, "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Adding fieldsets to a model's admin</a></li>\n</ul>\n", "prev": {"link": "../", "title": "Decorator App Patterns"}, "metatags": ""}