{"body": "<div class=\"section\" id=\"version-reporting\">\n<h1>Version Reporting<a class=\"headerlink\" href=\"#version-reporting\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p id=\"1\"><strong>Contributors:</strong> Corey Oordt</p>\n<div class=\"contents local topic\" id=\"contents\">\n<ul class=\"simple\">\n<li><a class=\"reference internal\" href=\"#what-problem-does-this-pattern-solve\" id=\"id1\">What problem does this pattern solve?</a></li>\n<li><a class=\"reference internal\" href=\"#when-to-use-it\" id=\"id2\">When to use it</a></li>\n<li><a class=\"reference internal\" href=\"#why-should-i-use-it\" id=\"id3\">Why should I use it?</a></li>\n<li><a class=\"reference internal\" href=\"#implementation\" id=\"id4\">Implementation</a></li>\n<li><a class=\"reference internal\" href=\"#how-to-use-it\" id=\"id5\">How to use it</a><ul>\n<li><a class=\"reference internal\" href=\"#inside-your-setup-py-file\" id=\"id6\">Inside your setup.py file</a></li>\n<li><a class=\"reference internal\" href=\"#inside-your-sphinx-documentation-s-conf-py\" id=\"id7\">Inside your Sphinx documentation&#8217;s conf.py</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"section\" id=\"what-problem-does-this-pattern-solve\">\n<h2><a class=\"toc-backref\" href=\"#id1\">What problem does this pattern solve?</a><a class=\"headerlink\" href=\"#what-problem-does-this-pattern-solve\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p id=\"2\">It provides a flexible method of recording and reporting your application&#8217;s version.</p>\n</div>\n<div class=\"section\" id=\"when-to-use-it\">\n<h2><a class=\"toc-backref\" href=\"#id2\">When to use it</a><a class=\"headerlink\" href=\"#when-to-use-it\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p id=\"3\">You should use it with any application or project that has specific releases.</p>\n</div>\n<div class=\"section\" id=\"why-should-i-use-it\">\n<h2><a class=\"toc-backref\" href=\"#id3\">Why should I use it?</a><a class=\"headerlink\" href=\"#why-should-i-use-it\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<ol class=\"arabic simple\">\n<li>It is easy to see which version is currently installed somewhere.</li>\n<li>It is easy to import the version into other places, like documentation or packaging.</li>\n<li>It is easy for others to test the version of your code to better handle backwards-compatibility.</li>\n</ol>\n</div>\n<div class=\"section\" id=\"implementation\">\n<h2><a class=\"toc-backref\" href=\"#id4\">Implementation</a><a class=\"headerlink\" href=\"#implementation\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p id=\"4\"><a class=\"reference external\" href=\"http://www.python.org/dev/peps/pep-0386/#the-new-versioning-algorithm\">PEP 386</a> defines the standard way to specify versions within the Python community. The most common scenario is the <tt class=\"docutils literal\"><span class=\"pre\">Major.Minor.Micro</span></tt> with a possible <tt class=\"docutils literal\"><span class=\"pre\">alpha/beta/release</span> <span class=\"pre\">candidate</span></tt> suffix.</p>\n<p id=\"5\">Examples:</p>\n<div class=\"highlight-python\"><pre>1.0\n0.6.1\n2.1.1b1\n0.3rc2</pre>\n</div>\n<p id=\"6\">When recording your version number you should:</p>\n<ul class=\"simple\">\n<li>Put it within the code, so it&#8217;s accessible after the package is installed</li>\n<li>Easily retrieve all the individual parts of the version</li>\n<li>Record the individual version parts as integers (where appropriate) for easy comparison</li>\n<li>Have a properly formatted string version available</li>\n</ul>\n<p id=\"7\">Putting the version information in your application&#8217;s <tt class=\"docutils literal\"><span class=\"pre\">__init__.py</span></tt> is a great, out-of-the-way place.</p>\n<p id=\"8\">Here is an example that I use:</p>\n<p class=\"caption\" id=\"9\"><strong>coolapp/__index__.py</strong></p>\n<div class=\"highlight-python\"><table class=\"highlighttable\"><tr><td class=\"linenos\"><div class=\"linenodiv\"><pre> 1\n 2\n 3\n 4\n 5\n 6\n 7\n 8\n 9\n10\n11\n12\n13\n14\n15\n16\n17\n18</pre></div></td><td class=\"code\"><div class=\"highlight\"><pre><span class=\"n\">__version_info__</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s\">&#39;major&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n    <span class=\"s\">&#39;minor&#39;</span><span class=\"p\">:</span> <span class=\"mi\">6</span><span class=\"p\">,</span>\n    <span class=\"s\">&#39;micro&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n    <span class=\"s\">&#39;releaselevel&#39;</span><span class=\"p\">:</span> <span class=\"s\">&#39;final&#39;</span><span class=\"p\">,</span>\n    <span class=\"s\">&#39;serial&#39;</span><span class=\"p\">:</span> <span class=\"mi\">1</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">get_version</span><span class=\"p\">(</span><span class=\"n\">short</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">):</span>\n    <span class=\"n\">vers</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">&quot;</span><span class=\"si\">%(major)i</span><span class=\"s\">.</span><span class=\"si\">%(minor)i</span><span class=\"s\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">__version_info__</span><span class=\"p\">,</span> <span class=\"p\">]</span>\n    \n    <span class=\"k\">if</span> <span class=\"n\">__version_info__</span><span class=\"p\">[</span><span class=\"s\">&#39;micro&#39;</span><span class=\"p\">]:</span>\n        <span class=\"n\">vers</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s\">&quot;.</span><span class=\"si\">%(micro)i</span><span class=\"s\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">__version_info__</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"n\">__version_info__</span><span class=\"p\">[</span><span class=\"s\">&#39;releaselevel&#39;</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"s\">&#39;final&#39;</span> <span class=\"ow\">and</span> <span class=\"ow\">not</span> <span class=\"n\">short</span><span class=\"p\">:</span>\n        <span class=\"n\">vers</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s\">&#39;</span><span class=\"si\">%(releaselevel)s%(serial)i</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">__version_info__</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"s\">&#39;&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">vers</span><span class=\"p\">)</span>\n\n<span class=\"n\">__version__</span> <span class=\"o\">=</span> <span class=\"n\">get_version</span><span class=\"p\">()</span>\n</pre></div>\n</td></tr></table></div>\n<p id=\"10\">This sets up a <tt class=\"docutils literal\"><span class=\"pre\">__version_info__</span></tt> dictionary to hold the version fields, a <tt class=\"docutils literal\"><span class=\"pre\">get_version()</span></tt> function to format the <tt class=\"docutils literal\"><span class=\"pre\">__version_info__</span></tt> into a string, and <tt class=\"docutils literal\"><span class=\"pre\">__version__</span></tt>, which is the formatted string version. It is similar to Django&#8217;s method:</p>\n<dl class=\"docutils\">\n<dt><strong>django/__init__.py</strong></dt>\n<dd><div class=\"first last highlight-python\"><table class=\"highlighttable\"><tr><td class=\"linenos\"><div class=\"linenodiv\"><pre> 1\n 2\n 3\n 4\n 5\n 6\n 7\n 8\n 9\n10\n11\n12\n13\n14\n15\n16</pre></div></td><td class=\"code\"><div class=\"highlight\"><pre><span class=\"n\">VERSION</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s\">&#39;alpha&#39;</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">get_version</span><span class=\"p\">():</span>\n    <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">&#39;</span><span class=\"si\">%s</span><span class=\"s\">.</span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n    <span class=\"k\">if</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]:</span>\n        <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">&#39;</span><span class=\"si\">%s</span><span class=\"s\">.</span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">version</span><span class=\"p\">,</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n    <span class=\"k\">if</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">:]</span> <span class=\"o\">==</span> <span class=\"p\">(</span><span class=\"s\">&#39;alpha&#39;</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">):</span>\n        <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">&#39;</span><span class=\"si\">%s</span><span class=\"s\"> pre-alpha&#39;</span> <span class=\"o\">%</span> <span class=\"n\">version</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"s\">&#39;final&#39;</span><span class=\"p\">:</span>\n            <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">&#39;</span><span class=\"si\">%s</span><span class=\"s\"> </span><span class=\"si\">%s</span><span class=\"s\"> </span><span class=\"si\">%s</span><span class=\"s\">&#39;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">version</span><span class=\"p\">,</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"n\">VERSION</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">])</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">django.utils.version</span> <span class=\"kn\">import</span> <span class=\"n\">get_svn_revision</span>\n    <span class=\"n\">svn_rev</span> <span class=\"o\">=</span> <span class=\"n\">get_svn_revision</span><span class=\"p\">()</span>\n    <span class=\"k\">if</span> <span class=\"n\">svn_rev</span> <span class=\"o\">!=</span> <span class=\"s\">u&#39;SVN-unknown&#39;</span><span class=\"p\">:</span>\n        <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">&quot;</span><span class=\"si\">%s</span><span class=\"s\"> </span><span class=\"si\">%s</span><span class=\"s\">&quot;</span> <span class=\"o\">%</span> <span class=\"p\">(</span><span class=\"n\">version</span><span class=\"p\">,</span> <span class=\"n\">svn_rev</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">version</span>\n</pre></div>\n</td></tr></table></div>\n</dd>\n</dl>\n</div>\n<div class=\"section\" id=\"how-to-use-it\">\n<h2><a class=\"toc-backref\" href=\"#id5\">How to use it</a><a class=\"headerlink\" href=\"#how-to-use-it\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"inside-your-setup-py-file\">\n<h3><a class=\"toc-backref\" href=\"#id6\">Inside your setup.py file</a><a class=\"headerlink\" href=\"#inside-your-setup-py-file\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p id=\"11\">The <tt class=\"docutils literal\"><span class=\"pre\">setup.py</span></tt> file needs a version for your application and you can import it directly from your application, ass seen in this example taken from <a class=\"reference external\" href=\"https://github.com/callowayproject/django-app-skeleton\">django-app-skeleton</a>&#8216;s <tt class=\"docutils literal\"><span class=\"pre\">setup.py</span></tt> file:</p>\n<p class=\"caption\" id=\"12\"><strong>django-app-skeleton/skel/setup.py</strong></p>\n<div class=\"highlight-python\"><table class=\"highlighttable\"><tr><td class=\"linenos\"><div class=\"linenodiv\"><pre> 1\n 2\n 3\n 4\n 5\n 6\n 7\n 8\n 9\n10\n11\n12\n13\n14\n15\n16\n17\n18</pre></div></td><td class=\"code\"><div class=\"highlight\"><pre><span class=\"c\"># ... other stuff above</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n    <span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s\">&quot;$$$$APP_NAME$$$$&quot;</span><span class=\"p\">,</span>\n    <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"nb\">__import__</span><span class=\"p\">(</span><span class=\"s\">&#39;$$$$PKG_NAME$$$$&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">get_version</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">replace</span><span class=\"p\">(</span><span class=\"s\">&#39; &#39;</span><span class=\"p\">,</span> <span class=\"s\">&#39;-&#39;</span><span class=\"p\">),</span>\n    <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s\">&#39;$$$$URL$$$$&#39;</span><span class=\"p\">,</span>\n    <span class=\"n\">author</span> <span class=\"o\">=</span> <span class=\"s\">&#39;$$$$AUTHOR$$$$&#39;</span><span class=\"p\">,</span>\n    <span class=\"n\">author_email</span> <span class=\"o\">=</span> <span class=\"s\">&#39;$$$$AUTHOR_EMAIL$$$$&#39;</span><span class=\"p\">,</span>\n    <span class=\"n\">description</span> <span class=\"o\">=</span> <span class=\"n\">DESC</span><span class=\"p\">,</span>\n    <span class=\"n\">long_description</span> <span class=\"o\">=</span> <span class=\"n\">get_readme</span><span class=\"p\">(),</span>\n    <span class=\"n\">packages</span> <span class=\"o\">=</span> <span class=\"n\">find_packages</span><span class=\"p\">(),</span>\n    <span class=\"n\">include_package_data</span> <span class=\"o\">=</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n    <span class=\"n\">install_requires</span> <span class=\"o\">=</span> <span class=\"n\">read_file</span><span class=\"p\">(</span><span class=\"s\">&#39;requirements.txt&#39;</span><span class=\"p\">),</span>\n    <span class=\"n\">classifiers</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n        <span class=\"s\">&#39;License :: OSI Approved :: Apache Software License&#39;</span><span class=\"p\">,</span>\n        <span class=\"s\">&#39;Framework :: Django&#39;</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n<span class=\"p\">)</span>\n</pre></div>\n</td></tr></table></div>\n</div>\n<div class=\"section\" id=\"inside-your-sphinx-documentation-s-conf-py\">\n<h3><a class=\"toc-backref\" href=\"#id7\">Inside your Sphinx documentation&#8217;s conf.py</a><a class=\"headerlink\" href=\"#inside-your-sphinx-documentation-s-conf-py\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p id=\"13\">Sphinx also likes to have the version of your application in the formatted documentation. Since the <tt class=\"docutils literal\"><span class=\"pre\">conf.py</span></tt> configuration file is just Python, you can import your version.</p>\n<p class=\"caption\" id=\"14\"><strong>coolapp/docs/conf.py</strong></p>\n<div class=\"highlight-python\"><table class=\"highlighttable\"><tr><td class=\"linenos\"><div class=\"linenodiv\"><pre> 1\n 2\n 3\n 4\n 5\n 6\n 7\n 8\n 9\n10\n11\n12\n13</pre></div></td><td class=\"code\"><div class=\"highlight\"><pre><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">abspath</span><span class=\"p\">(</span><span class=\"s\">&#39;..&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">environ</span><span class=\"p\">[</span><span class=\"s\">&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s\">&#39;example.settings&#39;</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">coolapp</span>\n\n<span class=\"c\"># The version info for the project you&#39;re documenting, acts as replacement for</span>\n<span class=\"c\"># |version| and |release|, also used in various other places throughout the</span>\n<span class=\"c\"># built documents.</span>\n<span class=\"c\">#</span>\n<span class=\"c\"># The short X.Y version.</span>\n<span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"n\">coolapp</span><span class=\"o\">.</span><span class=\"n\">get_version</span><span class=\"p\">(</span><span class=\"n\">short</span><span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">)</span>\n<span class=\"c\"># The full version, including alpha/beta/rc tags.</span>\n<span class=\"n\">release</span> <span class=\"o\">=</span> <span class=\"n\">coolapp</span><span class=\"o\">.</span><span class=\"n\">get_version</span><span class=\"p\">()</span>\n</pre></div>\n</td></tr></table></div>\n</div>\n</div>\n</div>\n", "display_toc": true, "title": "Version Reporting", "sourcename": "app_construction/version_reporting.txt", "customsidebar": null, "current_page_name": "app_construction/version_reporting", "next": {"link": "../views_as_a_package/", "title": "Views as a package"}, "rellinks": [["genindex", "General Index", "I", "index"], ["app_construction/views_as_a_package", "Views as a package", "N", "next"], ["app_construction/index", "Application Construction", "P", "previous"]], "meta": {"author": "Corey Oordt"}, "parents": [{"link": "../", "title": "Application Construction"}], "sidebars": null, "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Version Reporting</a><ul>\n<li><a class=\"reference internal\" href=\"#what-problem-does-this-pattern-solve\">What problem does this pattern solve?</a></li>\n<li><a class=\"reference internal\" href=\"#when-to-use-it\">When to use it</a></li>\n<li><a class=\"reference internal\" href=\"#why-should-i-use-it\">Why should I use it?</a></li>\n<li><a class=\"reference internal\" href=\"#implementation\">Implementation</a></li>\n<li><a class=\"reference internal\" href=\"#how-to-use-it\">How to use it</a><ul>\n<li><a class=\"reference internal\" href=\"#inside-your-setup-py-file\">Inside your setup.py file</a></li>\n<li><a class=\"reference internal\" href=\"#inside-your-sphinx-documentation-s-conf-py\">Inside your Sphinx documentation&#8217;s conf.py</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "prev": {"link": "../", "title": "Application Construction"}, "metatags": ""}